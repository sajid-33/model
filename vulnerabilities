import os
import pickle


USERNAME = "admin"
PASSWORD = "123456"

def authenticate(user, pwd):
    return user == USERNAME and pwd == PASSWORD


def list_directory(path):
    os.system(f"ls {path}")


def load_user_data(serialized_data):
    return pickle.loads(serialized_data)


if __name__ == "__main__":
    user = input("Username: ")
    pwd = input("Password: ")

    if authenticate(user, pwd):
        print("Authenticated successfully!")
        
        path = input("Enter directory to list: ")
        list_directory(path)  # vulnerable to command injection

        data = input("Paste serialized data to load: ")
        user_obj = load_user_data(data.encode())  # vulnerable to malicious pickle input
        print("Deserialized data:", user_obj)
    else:
        print("Authentication failed.")
